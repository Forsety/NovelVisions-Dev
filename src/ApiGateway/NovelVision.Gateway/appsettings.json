{
  "Logging": {
    "LogLevel": {
      "Default": "Information",
      "Microsoft.AspNetCore": "Warning",
      "Ocelot": "Information"
    }
  },
  "AllowedHosts": "*",

  "Cors": {
    "AllowedOrigins": [
      "http://localhost:3000",
      "http://localhost:5000",
      "https://localhost:7000",
      "http://localhost:5173",
      "https://localhost:5173"
    ]
  },

  "JwtSettings": {
    "Secret": "ReY+9V20WM0tH9jG6Ot2gh/TIDWk4M+ya8wpZ68LQX8QJ2DrPWaIn6jcmSds0st5EPwsygwG2TwAkRsoeK0wew==",
    "Issuer": "NovelVision.Gateway",
    "Audience": "NovelVision.Client",
    "AccessTokenExpirationMinutes": 60
  },

  "ServiceEndpoints": {
    "CatalogApi": {
      "Http": "http://localhost:5231",
      "Https": "https://localhost:7295"
    },
    "VisualizationApi": {
      "Http": "http://localhost:5284",
      "Https": "https://localhost:7130"
    },
    "PromptGenApi": {
      "Http": "http://localhost:8000"
    }
  },

  "IpRateLimiting": {
    "EnableEndpointRateLimiting": true,
    "StackBlockedRequests": false,
    "RealIpHeader": "X-Real-IP",
    "ClientIdHeader": "X-ClientId",
    "HttpStatusCode": 429,
    "IpWhitelist": [ "127.0.0.1", "::1" ],
    "EndpointWhitelist": [ "get:/health", "get:/health/*" ],
    "ClientWhitelist": [],
    "GeneralRules": [
      {
        "Endpoint": "*",
        "Period": "1m",
        "Limit": 200
      },
      {
        "Endpoint": "*:/auth/login",
        "Period": "1m",
        "Limit": 10
      },
      {
        "Endpoint": "*:/auth/register",
        "Period": "1h",
        "Limit": 5
      },
      {
        "Endpoint": "*:/visualization/generate*",
        "Period": "1m",
        "Limit": 20
      },
      {
        "Endpoint": "*:/promptgen/visualization/*",
        "Period": "1m",
        "Limit": 60
      }
    ]
  },

  "ClientRateLimiting": {
    "EnableEndpointRateLimiting": true,
    "StackBlockedRequests": false,
    "ClientIdHeader": "X-ClientId",
    "HttpStatusCode": 429,
    "GeneralRules": [
      {
        "Endpoint": "*",
        "Period": "1m",
        "Limit": 100
      }
    ]
  },

  "Serilog": {
    "Using": [ "Serilog.Sinks.Console", "Serilog.Sinks.File" ],
    "MinimumLevel": {
      "Default": "Information",
      "Override": {
        "Microsoft": "Warning",
        "Microsoft.AspNetCore": "Warning",
        "Microsoft.Hosting.Lifetime": "Information",
        "Ocelot": "Information",
        "System": "Warning"
      }
    },
    "WriteTo": [
      {
        "Name": "Console",
        "Args": {
          "outputTemplate": "[{Timestamp:HH:mm:ss} {Level:u3}] {SourceContext}: {Message:lj}{NewLine}{Exception}"
        }
      },
      {
        "Name": "File",
        "Args": {
          "path": "logs/gateway-.txt",
          "rollingInterval": "Day",
          "retainedFileCountLimit": 14,
          "outputTemplate": "{Timestamp:yyyy-MM-dd HH:mm:ss.fff zzz} [{Level:u3}] {SourceContext}: {Message:lj}{NewLine}{Exception}"
        }
      }
    ],
    "Enrich": [ "FromLogContext", "WithMachineName", "WithThreadId" ],
    "Properties": {
      "Application": "NovelVision.Gateway"
    }
  },

  "HealthChecks": {
    "Timeout": 5,
    "Services": {
      "CatalogApi": "https://localhost:7295/health",
      "VisualizationApi": "https://localhost:7130/health",
      "PromptGenApi": "http://localhost:8000/api/v1/health"
    }
  }
}